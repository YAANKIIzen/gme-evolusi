<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ðŸ§¬ Evo Goks - Game Edukasi Evolusi Manusia</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    
    <!-- Icons & Meta -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§¬</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§¬</text></svg>">
    
    <!-- Mobile Meta -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <meta name="mobile-web-app-capable" content="yes">
</head>
<body>
    <!-- Audio Elements -->
    <audio id="bgmAudio" loop preload="auto">
        <source src="assets/sound/bgm.mp3" type="audio/mpeg">
    </audio>
    <audio id="correctSound" preload="auto">
        <source src="assets/sound/correct.mp3" type="audio/mpeg">
    </audio>
    <audio id="wrongSound" preload="auto">
        <source src="assets/sound/wrong.mp3" type="audio/mpeg">
    </audio>
    <audio id="evolveSound" preload="auto">
        <source src="assets/sound/evolve.mp3" type="audio/mpeg">
    </audio>
    <audio id="warningSound" preload="auto">
        <source src="assets/sound/warning.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Touch Overlay -->
    <div class="touch-overlay"></div>
    
    <!-- ==================== LOADING SCREEN ==================== -->
    <div id="loadingScreen" class="screen">
        <div class="loading-container">
            <div class="loading-spinner"></div>
            <h2 id="loadingTitle">Memuat Evo Goks...</h2>
            <p class="loading-text" id="loadingSubtitle">Game Edukasi Evolusi Manusia</p>
            <div class="progress-bar loading">
                <div class="progress-fill" id="loadingProgress"></div>
            </div>
            
            <!-- Error message -->
            <div class="loading-error" id="loadingError">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Gagal memuat game. Coba refresh halaman.</p>
                <button onclick="window.location.reload()" class="retry-btn">
                    <i class="fas fa-redo"></i> Refresh
                </button>
            </div>
            
            <!-- Skip loading button -->
            <button class="skip-loading-btn" id="skipLoadingBtn">
                Lewati loading <i class="fas fa-forward"></i>
            </button>
        </div>
    </div>

    <!-- ==================== MENU SCREEN ==================== -->
    <div id="menuScreen" class="screen hidden">
        <div class="game-container">
            <!-- Header Mobile -->
            <div class="mobile-header">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <h1><i class="fas fa-dna"></i> Evo Goks</h1>
                <button class="mobile-sound-btn" id="mobileSoundBtn">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
            
            <div class="game-header">
                <p class="subtitle">Game Edukasi Evolusi Manusia</p>
            </div>
            
            <!-- Mobile Menu -->
            <div class="mobile-menu" id="mobileMenu">
                <div class="mobile-menu-header">
                    <h3>Menu</h3>
                    <button class="close-menu-btn" id="closeMenuBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="mobile-menu-options">
                    <button class="mobile-menu-option" data-action="start">
                        <i class="fas fa-gamepad"></i> Mulai Game
                    </button>
                    <button class="mobile-menu-option" data-action="ranking">
                        <i class="fas fa-trophy"></i> Ranking
                    </button>
                    <button class="mobile-menu-option" data-action="rules">
                        <i class="fas fa-book"></i> Cara Main
                    </button>
                    <button class="mobile-menu-option" id="soundToggleMenu">
                        <i class="fas fa-volume-up"></i> Sound: <span id="soundStatusMenu">ON</span>
                    </button>
                    <button class="mobile-menu-option" data-action="about">
                        <i class="fas fa-info-circle"></i> Tentang
                    </button>
                </div>
            </div>
            
            <!-- Character Display -->
            <div class="character-display-menu">
                <div class="character-circle">
                    <div class="character-img-container">
                        <img id="menuCharacterImg" src="assets/characters/stage1_ape.png" alt="Kera Purba" class="character-image">
                    </div>
                </div>
                <div class="character-info-menu">
                    <h3 id="menuStageName">Kera Purba</h3>
                    <p id="menuStageDesc">Cikal bakal primata manusia (15 juta tahun lalu)</p>
                </div>
            </div>
            
            <div class="menu-options">
                <div class="input-group">
                    <label for="playerName"><i class="fas fa-user"></i> Nama Pemain:</label>
                    <input type="text" id="playerName" placeholder="Masukkan nama" maxlength="15" value="Player">
                </div>
                
                <div class="mobile-quick-buttons">
                    <button id="startBtn" class="menu-btn primary">
                        <i class="fas fa-play"></i> Main
                    </button>
                    <button id="rankingBtn" class="menu-btn secondary">
                        <i class="fas fa-trophy"></i> Ranking
                    </button>
                    <button id="rulesBtn" class="menu-btn tertiary">
                        <i class="fas fa-question-circle"></i> Bantuan
                    </button>
                </div>
                
                <!-- Mobile Controls -->
                <div class="mobile-controls-toggle">
                    <span><i class="fas fa-gamepad"></i> Kontrol Game</span>
                    <button class="toggle-btn" id="controlsToggle">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>
                
                <div class="mobile-controls-info" id="mobileControlsInfo">
                    <div class="control-item">
                        <span class="key">1-5</span>
                        <span>Pilih jawaban</span>
                    </div>
                    <div class="control-item">
                        <span class="key">P</span>
                        <span>Jeda game</span>
                    </div>
                    <div class="control-item">
                        <span class="key">H</span>
                        <span>Petunjuk</span>
                    </div>
                    <div class="control-item">
                        <span class="key">M</span>
                        <span>Sound</span>
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards -->
            <div class="mobile-stats-cards">
                <div class="stat-card-mobile">
                    <i class="fas fa-clock"></i>
                    <div>
                        <h4>3 Menit</h4>
                        <p>Waktu Main</p>
                    </div>
                </div>
                <div class="stat-card-mobile">
                    <i class="fas fa-brain"></i>
                    <div>
                        <h4>50+ Soal</h4>
                        <p>Variasi Pertanyaan</p>
                    </div>
                </div>
                <div class="stat-card-mobile">
                    <i class="fas fa-layer-group"></i>
                    <div>
                        <h4>6 Tahap</h4>
                        <p>Tahap Evolusi</p>
                    </div>
                </div>
            </div>
            
            <div class="footer mobile-footer">
                <p>Â© 2024 Evo Goks - Game Edukasi Evolusi Manusia</p>
                <p class="version">v2.1 (5 Opsi Jawaban)</p>
            </div>
        </div>
    </div>

    <!-- ==================== GAME SCREEN ==================== -->
    <div id="gameScreen" class="screen hidden">
        <div class="game-container">
            <!-- Mobile Game Header -->
            <div class="mobile-game-header">
                <button class="back-game-btn" id="backGameBtn">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="mobile-game-title">
                    <h2><i class="fas fa-dna"></i> Evo Goks</h2>
                    <p id="mobilePlayerName">Pemain</p>
                </div>
                <button class="mobile-game-menu-btn" id="mobileGameMenuBtn">
                    <i class="fas fa-ellipsis-v"></i>
                </button>
            </div>
            
            <!-- Mobile Game Menu -->
            <div class="mobile-game-menu" id="mobileGameMenu">
                <div class="mobile-game-menu-content">
                    <button class="game-menu-option" id="pauseGameBtn">
                        <i class="fas fa-pause"></i> <span id="pauseText">Jeda Game</span>
                    </button>
                    <button class="game-menu-option" id="hintGameBtn">
                        <i class="fas fa-lightbulb"></i> Petunjuk (<span id="mobileHintCount">3</span>)
                    </button>
                    <button class="game-menu-option" id="soundGameBtn">
                        <i class="fas fa-volume-up"></i> Sound
                    </button>
                    <button class="game-menu-option" id="backToMenuBtnGame">
                        <i class="fas fa-home"></i> Kembali ke Menu
                    </button>
                </div>
            </div>
            
            <!-- Game Stats -->
            <div class="game-stats mobile-stats">
                <div class="mobile-timer-container">
                    <div class="mobile-timer" id="mobileTimer">
                        <i class="fas fa-clock"></i>
                        <span id="timer">03:00</span>
                    </div>
                    <div class="mobile-score" id="mobileScore">
                        <i class="fas fa-star"></i>
                        <span id="score">0</span>
                    </div>
                </div>
                
                <div class="mobile-progress-container">
                    <div class="mobile-progress-info">
                        <span>Tahap <b id="level">1</b></span>
                        <span>Evolusi <b id="evoStage">1/6</b></span>
                    </div>
                    <div class="mobile-progress-bar">
                        <div class="progress-fill" id="mobileEvoProgress"></div>
                    </div>
                </div>
            </div>
            
            <!-- Karakter Evolusi -->
            <div class="character-evolution-mobile">
                <div class="character-display-mobile">
                    <div class="character-image-container">
                        <div class="character-img-container-game">
                            <img id="characterImg" src="assets/characters/stage1_ape.png" alt="Kera Purba" class="character-image-game">
                        </div>
                        <div class="character-stage-badge" id="characterStageBadge">
                            <span>1</span>
                        </div>
                    </div>
                    <div class="character-info-mobile">
                        <h3 id="stageName">Kera Purba</h3>
                        <p id="stageDesc">Cikal bakal primata manusia</p>
                        
                        <button class="evolution-info-btn" id="evolutionInfoTouch">
                            <i class="fas fa-info-circle"></i>
                            <span>Info Evolusi</span>
                        </button>
                    </div>
                </div>
                
                <!-- Timeline -->
                <div class="timeline-mobile-container">
                    <div class="timeline-track" id="timelineTrack">
                        <div class="timeline-step-mobile active">
                            <div class="timeline-circle">1</div>
                            <span>Kera</span>
                        </div>
                        <div class="timeline-step-mobile">
                            <div class="timeline-circle">2</div>
                            <span>Australo.</span>
                        </div>
                        <div class="timeline-step-mobile">
                            <div class="timeline-circle">3</div>
                            <span>H. Habilis</span>
                        </div>
                        <div class="timeline-step-mobile">
                            <div class="timeline-circle">4</div>
                            <span>H. Erectus</span>
                        </div>
                        <div class="timeline-step-mobile">
                            <div class="timeline-circle">5</div>
                            <span>H. Sapiens</span>
                        </div>
                        <div class="timeline-step-mobile">
                            <div class="timeline-circle">6</div>
                            <span>Modern</span>
                        </div>
                    </div>
                    <div class="timeline-progress-mobile" id="timelineProgressMobile"></div>
                </div>
            </div>
            
            <!-- Game Content -->
            <div class="game-content-mobile">
                <div id="questionBox" class="question-box-mobile">
                    <div class="question-header-mobile">
                        <div class="question-number-mobile">
                            <i class="fas fa-question-circle"></i>
                            <span>#<span id="questionNumber">1</span></span>
                        </div>
                        <div class="question-timer-mobile">
                            <div class="question-time-bar-mobile">
                                <div class="question-time-fill-mobile" id="questionTimeMobile"></div>
                            </div>
                            <span><b id="timeLeft">15</b>s</span>
                        </div>
                    </div>
                    <p id="question" class="question-text-mobile">Memuat pertanyaan...</p>
                </div>
                
                <!-- Answers Grid 5 opsi -->
                <div id="answers" class="answers-grid-mobile">
                    <!-- Tombol jawaban akan dimuat di sini -->
                </div>
                
                <!-- Status -->
                <div id="statusBox" class="status-box-mobile">
                    <div class="status-content-mobile">
                        <i class="fas fa-info-circle"></i>
                        <p id="status">Selamat bermain! Jawab dengan cepat!</p>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="mobile-quick-actions">
                    <button class="quick-action-btn hint-action" id="mobileHintBtn">
                        <i class="fas fa-lightbulb"></i>
                        <span>Petunjuk</span>
                    </button>
                    <button class="quick-action-btn pause-action" id="mobilePauseBtn">
                        <i class="fas fa-pause"></i>
                        <span>Jeda</span>
                    </button>
                    <button class="quick-action-btn skip-action" id="mobileSkipBtn">
                        <i class="fas fa-forward"></i>
                        <span>Lewati</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== RANKING SCREEN ==================== -->
    <div id="rankingScreen" class="screen hidden">
        <div class="game-container">
            <div class="mobile-game-header">
                <button class="back-game-btn" id="backFromRankingMobile">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="mobile-game-title">
                    <h2><i class="fas fa-trophy"></i> Ranking</h2>
                    <p>Peringkat Pemain</p>
                </div>
                <div class="header-spacer"></div>
            </div>
            
            <div class="ranking-content-mobile">
                <!-- Filter -->
                <div class="ranking-filters-mobile">
                    <div class="filter-scroll">
                        <button class="filter-chip active" data-filter="all">
                            Semua
                        </button>
                        <button class="filter-chip" data-filter="today">
                            Hari Ini
                        </button>
                        <button class="filter-chip" data-filter="week">
                            Minggu Ini
                        </button>
                        <button class="filter-chip" data-filter="month">
                            Bulan Ini
                        </button>
                    </div>
                </div>
                
                <!-- Stats Cards -->
                <div class="ranking-stats-mobile">
                    <div class="stat-card-ranking">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <small>Total Pemain</small>
                            <h3 id="totalPlayers">0</h3>
                        </div>
                    </div>
                    <div class="stat-card-ranking">
                        <div class="stat-icon">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-info">
                            <small>Skor Tertinggi</small>
                            <h3 id="highestScore">0</h3>
                        </div>
                    </div>
                    <div class="stat-card-ranking">
                        <div class="stat-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div class="stat-info">
                            <small>Rata-rata</small>
                            <h3 id="averageScore">0</h3>
                        </div>
                    </div>
                </div>
                
                <!-- Ranking List -->
                <div class="ranking-list-mobile" id="rankingListMobile">
                    <div class="empty-ranking-mobile">
                        <i class="fas fa-trophy"></i>
                        <h3>Belum ada ranking</h3>
                        <p>Mainkan game untuk tampil di sini!</p>
                    </div>
                </div>
                
                <button class="refresh-btn" id="refreshRanking">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== RESULT SCREEN ==================== -->
    <div id="resultScreen" class="screen hidden">
        <div class="game-container">
            <div class="mobile-game-header result-header">
                <div class="mobile-game-title">
                    <h2><i class="fas fa-award"></i> Hasil Game</h2>
                    <p id="resultSubtitle">Permainan Selesai</p>
                </div>
            </div>
            
            <div class="result-content-mobile">
                <!-- Badge -->
                <div class="result-badge-mobile" id="resultBadgeMobile">
                    <div class="badge-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <div class="badge-text" id="resultTitleMobile">
                        <h3>Waktu Habis!</h3>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="result-stats-mobile">
                    <div class="result-stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-user-tag"></i>
                        </div>
                        <div class="stat-details">
                            <small>Nama</small>
                            <h4 id="resultName">-</h4>
                        </div>
                    </div>
                    <div class="result-stat-card highlight">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-details">
                            <small>Skor</small>
                            <h4 id="resultScore" class="score-highlight">0</h4>
                        </div>
                    </div>
                    <div class="result-stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-dna"></i>
                        </div>
                        <div class="stat-details">
                            <small>Evolusi</small>
                            <h4 id="resultStage">Kera Purba</h4>
                        </div>
                    </div>
                    <div class="result-stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-details">
                            <small>Peringkat</small>
                            <h4 id="resultRank">-</h4>
                        </div>
                    </div>
                </div>
                
                <!-- Materi -->
                <div class="material-section-mobile">
                    <div class="material-header" id="materialHeader">
                        <h3><i class="fas fa-book-open"></i> Materi Evolusi</h3>
                        <button class="collapse-btn" id="collapseMaterialBtn">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    <div class="material-content-mobile" id="materialContentMobile">
                        <!-- Materi akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="result-actions-mobile">
                    <button id="playAgainBtn" class="action-btn primary-action">
                        <i class="fas fa-redo"></i> Main Lagi
                    </button>
                    <button id="saveScoreBtn" class="action-btn success-action">
                        <i class="fas fa-save"></i> Simpan Skor
                    </button>
                    <button id="backToMenuBtnResult" class="action-btn">
                        <i class="fas fa-home"></i> Menu
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== RULES SCREEN ==================== -->
    <div id="rulesScreen" class="screen hidden">
        <div class="game-container">
            <div class="mobile-game-header">
                <button class="back-game-btn" id="backFromRules">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="mobile-game-title">
                    <h2><i class="fas fa-book"></i> Cara Main</h2>
                    <p>Panduan Game</p>
                </div>
                <div class="header-spacer"></div>
            </div>
            
            <div class="rules-content-mobile">
                <div class="rules-section">
                    <h3><i class="fas fa-gamepad"></i> Tujuan Game</h3>
                    <p>Jawab pertanyaan tentang evolusi manusia secepat dan seakurat mungkin untuk berevolusi dari Kera Purba menjadi Manusia Modern!</p>
                </div>
                
                <div class="rules-section">
                    <h3><i class="fas fa-star"></i> Sistem Poin</h3>
                    <ul>
                        <li>Jawaban benar: <strong>+150 poin</strong></li>
                        <li>Jawaban cepat (5 detik): <strong>+75 bonus</strong></li>
                        <li>Jawaban salah: <strong>-50 poin</strong></li>
                        <li>5 jawaban benar beruntun: <strong>+300 bonus</strong></li>
                        <li>Bonus 5 opsi: <strong>+50 poin</strong></li>
                    </ul>
                </div>
                
                <div class="rules-section">
                    <h3><i class="fas fa-dna"></i> Evolusi</h3>
                    <p>Setiap 250 poin, karakter Anda akan berevolusi ke tahap berikutnya. Terdapat 6 tahap evolusi.</p>
                </div>
                
                <div class="rules-section">
                    <h3><i class="fas fa-clock"></i> Waktu</h3>
                    <p>Anda memiliki waktu 3 menit. Setiap pertanyaan harus dijawab dalam 15 detik.</p>
                </div>
                
                <div class="rules-section">
                    <h3><i class="fas fa-lightbulb"></i> Petunjuk</h3>
                    <p>Anda memiliki 3 petunjuk yang bisa digunakan untuk menghilangkan 3 jawaban salah.</p>
                </div>
                
                <div class="rules-section">
                    <h3><i class="fas fa-keyboard"></i> Kontrol</h3>
                    <p>Gunakan tombol 1-5 untuk memilih jawaban, P untuk jeda, H untuk petunjuk, M untuk mute sound.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
        <div class="toast-content">
            <i class="toast-icon"></i>
            <p class="toast-message"></p>
        </div>
    </div>

    <!-- Script -->
    <script src="script.js"></script>
    
    <!-- Loading protection -->
    <script>
    // Emergency skip loading after 5 seconds
    setTimeout(() => {
        const loadingScreen = document.getElementById('loadingScreen');
        const menuScreen = document.getElementById('menuScreen');
        
        if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
            console.log("Auto-skipping loading screen");
            loadingScreen.classList.add('hidden');
            if (menuScreen) {
                menuScreen.classList.remove('hidden');
            }
        }
    }, 5000);
    
    // Skip loading button
    document.getElementById('skipLoadingBtn')?.addEventListener('click', function() {
        const loadingScreen = document.getElementById('loadingScreen');
        const menuScreen = document.getElementById('menuScreen');
        
        if (loadingScreen) loadingScreen.classList.add('hidden');
        if (menuScreen) menuScreen.classList.remove('hidden');
    });
    </script>
</body>
</html>